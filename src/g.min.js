function o(t){t=t&&t.getBoundingClientRect();var e=Number(window.scrollX||window.pageXOffset||0),r=Number(window.scrollY||window.pageYOffset||0);return t&&{left:t.left+e,top:t.top+r}}function i(){var t=document.getElementById("commits-table");if(t||(t=document.getElementById("compare-commits-table")),!t)return null;for(var e=t.getElementsByTagName("tr"),r=0,o=e.item(r);o&&!o.getAttribute("data-commitid");)o=e.item(++r);return o&&[r,o,e,o.getAttribute("data-commitid")]}function n(){var e=document.getElementById("bit-booster");e||(e=document.createElementNS(r,"svg"),e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e.setAttribute("width",25),e.setAttribute("height",20),e.setAttribute("text-rendering","optimizeLegibility"),e.setAttributeNS("http://www.w3.org/1999/xhtml","style","border: 0px; margin: 0px; padding: 0;"),e.id="bit-booster"),t.svg=e;var o=document.getElementById("bit-booster-tbl");if(o)t.tdL||(t.tdL=o.getElementsByTagName("td").item(0)),t.tdL.appendChild(e);else{var n=document.getElementsByClassName("commits-content").item(0);n||(n=document.getElementById("compare-content")),o=document.createElement("table"),o.id="bit-booster-tbl",o.style.width="1%";var a=o.insertRow(),i=a.insertCell(-1),s=a.insertCell(-1);i.style.verticalAlign="top",s.style.width="99%",s.style.verticalAlign="top",n.appendChild(o),style=document.createElement("style"),style.setAttribute("type","text/css"),style.textContent='\n        @font-face {\n            font-family: "Atlassian Icons";\n            src: url(http://aui-cdn.atlassian.com/aui-adg/5.9.6/css/fonts/atlassian-icons.eot);\n            src: url(http://aui-cdn.atlassian.com/aui-adg/5.9.6/css/fonts/atlassian-icons.eot?#iefix) format("embedded-opentype"), url(http://aui-cdn.atlassian.com/aui-adg/5.9.6/css/fonts/atlassian-icons.woff) format("woff"), url(http://aui-cdn.atlassian.com/aui-adg/5.9.6/css/fonts/atlassian-icons.ttf) format("truetype"), url(http://aui-cdn.atlassian.com/aui-adg/5.9.6/css/fonts/atlassian-icons.svg#atlassian-icons) format("svg");\n            font-weight: normal;\n            font-style: normal;\n        }\n        #bit-booster-tbl, #bit-booster-tbl * { line-height: 1.0; font-family: monospace; border-spacing: 0; margin:0; border: 0; padding: 0; font-size: 16px;}\n        #bit-booster-tbl span.icon { font-family: "Atlassian Icons"; font-size: 16px; padding-left: 2px; }\n        #bit-booster-tbl td.d { font-style: italic; color: darkgray; padding-left: 0.7em; white-space: nowrap; }\n        #bit-booster-tbl td.commit { padding: 4px 1px; }\n',i.appendChild(e),i.setAttribute("rowspan",99999),t.tdL=i,t.style=style}}function a(){function e(t,e,r){g[t]||(g[t]=[]),g[t][e]=r}function a(t,e){return g[t]&&g[t][e]}function s(t){return t.parents&&t.parents.length>1}function l(n){var i=t.svg,l=o(i),c=t.commitsList,d=n;n.pathsDrawn=Object.create(null),n.drawPathTo=function(t){if(!n.pathsDrawn[t.sha1]){n.pathsDrawn[t.sha1]=!0;var e=t.col-n.col,r=n.col;e>0&&(r+=e);for(var o=t.row-n.row,i=!1,l=!1;!l;){for(var m=!1,f=1;o>f;f++){var g=c[n.row+f];if(r===g.col){i=!0,m=!0,r++;break}var h=a(n.row+f,r);if(h&&h!==t){i=!0,m=!0,r++;break}}m||(l=!0)}var p=n.pos(t);if(i){b=Math.max(b,r),h=a(n.row,r);var w=n.prevParent(t),y=t.col;if(w)y=w.col+1;t==a(n.row,y)?(p=n.pos(c[n.row+1]),r=t.col,p.setColor(t.col),n.curveLeft(p,t.col-n.col,t),n.path(p,t.row+1,t.col,t)):(s(d)||h&&h!==d?(p.setColor(r),n.curveRight(p,r-n.col,t)):(n.col=r,n.x=v+u*n.col,e=t.col-n.col,p=n.pos(t)),p.setColor(r),n.path(p,t.row-1,r,t),n.curveLeft(p,t.col-r,t)),t.colorOverride=r}else e>0?(n.curveRight(p,e,t),n.path(p,t.row,r,t)):0>e?(n.path(p,t.row-1,r,t),n.curveLeft(p,e,t)):n.path(p,t.row,r,t)}},n.prevParent=function(t){if(t&&t.sha1&&n.parents&&n.parents.length>1)for(var e=1;e<n.parents.length;e++)if(t.sha1===n.parents[e])return h[n.parents[e-1]]},n.plumb=function(){var e=t.commitsList;if(!n.isPlumbed){var r=o(n.htmlElement);n.y=11+r.top-l.top;var a=void 0;if(n.parents&&n.parents.length>0)for(var i=0;i<n.parents.length;i++){var s=h[n.parents[i]];if(s&&!s.isPlumbed){0==i?a=s.plumb():s.plumb();r=s.col-n.col;var c=s.row-n.row;if(0===r&&(r=i),r>=0)var m=n.col+r;else m=n.col;for(var f=1;c>f;f++){var g=e[n.row+f];g&&!g.isPlumbed&&(g.col=m+1,g.x=v+u*g.col,b=Math.max(g.col,b))}}else 0==i&&(a=d)}else a=d;return n.isPlumbed=!0,a}},n.draw=function(){if(!n.isDone){n.isDone=!0;for(var t=0;n.parents&&t<n.parents.length;t++){var e=h[n.parents[t]];e?(n.drawPathTo(e),e.draw()):n.path(n.pos(),n.row+1,n.col,void 0,!0)}}},n.pos=function(e){var r=t.commitsList,o=[n.x,n.y];return o.setColor=function(t){Number(t)===t&&(o.color=m[t%m.length],o.srcColor=o.color)},o.setColor(e&&e.col),o.srcColor=m[n.col%m.length],o.color||(o.color=o.srcColor),n.colorOverride&&0!==n.col&&o.setColor(n.colorOverride),o.below=function(t){var e=r[t],n=e&&e.y;return n||(n=r[r.length-1].y+f),[o[0],n]},o.right=function(t){return w=[o[0]+u*t,o[1]+f],e&&r.length>n.row+1&&(w[1]=r[n.row+1].y),[o[0]-1,o[1]+.75*f,o[0]+u*t+1,o[1]+.25*f,w[0],w[1]]},o.left=function(t){return[o[0]+1,o[1]+.75*f,o[0]+u*t-1,o[1]+.25*f,o[0]+u*t,e.y]},o},n.curveRight=function(t,o,a){a&&e(n.row+1,n.col+o,a);var i=t.right(o),s=document.createElementNS(r,"path");s.setAttribute("d","M"+t.join(",")+"C"+i.join(",")),s.setAttribute("stroke-width",2),s.setAttribute("stroke-opacity",1),s.setAttribute("opacity",1),s.setAttribute("fill","none"),s.setAttribute("stroke",t.color),n.drawEarlier(s),t[0]=i[i.length-2],t[1]=i[i.length-1]},n.curveLeft=function(t,e){var o=t.left(e),a=document.createElementNS(r,"path");a.setAttribute("d","M"+t.join(",")+"C"+o.join(",")),a.setAttribute("stroke-width",2),a.setAttribute("stroke-opacity",1),a.setAttribute("opacity",1),a.setAttribute("fill","none"),a.setAttribute("stroke",t.srcColor),n.drawEarlier(a),t[0]=o[o.length-2],t[1]=o[o.length-1]},n.path=function(o,a,i,s,l){var c=t.svg,d=t.commitsList;if(!l&&s)for(var m=n.row+1;a>m;m++)e(m,i,s);var f=document.createElementNS(r,"path"),b=o.below(a);l&&n.row!==d.length-1&&(b[0]=o[0]+1.5*u,b[1]=o[1]+.7*(b[1]-o[1])),f.setAttribute("d","M"+o.join(",")+"L"+b.join(",")),f.setAttribute("stroke-width",2),f.setAttribute("stroke-opacity",1),l&&f.setAttribute("stroke-dasharray","15,3,3,3,3,3,3,3,3,3,3"),f.setAttribute("opacity",1),s&&s.col&&n.col<s.col?f.setAttribute("stroke",o.color):f.setAttribute("stroke",o.srcColor),c.appendChild(f),o[1]=b[1];var g=c.getAttribute("width");g<o[0]+15&&c.setAttribute("width",o[0]+15)},n.drawEarlier=function(e){var r=t.svg;r.firstChild?r.insertBefore(e,r.firstChild):r.appendChild(e)},n.circle=function(){var e=void 0,o=n.pos(),a=t.svg,i=a.getAttribute("width"),s=a.getAttribute("height"),l=document.createElementNS(r,"rect");l.id="R_"+n.sha1,l.setAttribute("x",0),l.setAttribute("y",Number(o[1]-14)),l.setAttribute("width","100%"),l.setAttribute("height",28),l.setAttribute("stroke","none"),l.setAttribute("stroke-width",0),l.setAttribute("fill","transparent"),a.appendChild(l);var c=document.createElementNS(r,"circle");c.id="C_"+n.sha1,c.setAttribute("cx",o[0]),c.setAttribute("cy",o[1]),c.setAttribute("r",4),c.setAttribute("fill",o.color),c.setAttribute("stroke","none"),a.appendChild(c);var d=n.tags&&n.tags.length>0,m=n.branches&&n.branches.length>0,u=d&&m,f=void 0;m&&(f=n.insertTag(o,!1,u,e)),d&&n.insertTag(o,!0,u,e,f);for(var b=document.getElementById("T_"+n.sha1),g=b.getElementsByTagName("td"),h=g.length-1;3>h;h++){var v=b.insertCell(-1);v.textContent=" "}i<o[0]&&a.setAttribute("width",o[0]+10),s<o[1]&&a.setAttribute("height",o[1]+10)},n.insertTag=function(t,e,r,o,a){var i=document.getElementById("T_"+n.sha1),s=e?n.tags:n.branches,l=i.insertCell(-1);l.setAttribute("class","d"),l.textContent=" "+s.join(", ");var c=document.createElement("span");return c.setAttribute("class","icon"),c.textContent=e?"":"",l.appendChild(c),{}}}function c(t){function e(t){return t.sort().filter(function(t,e,r){return!e||t!=r[e-1]})}t=t.trim(),"("===t.charAt(0)&&(t=t.substr(1)),")"===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),t=t.trim();for(var r=[],o=[],n=t.split(", "),a=0;a<n.length;a++){var i=n[a];0==i.indexOf("tag: ")?r.push(i.substr(5)):i.indexOf("refs/pull-requests/")>=0||o.push(i)}return[e(r),e(o)]}function d(r){function o(t){if(t.branches&&t.branches.length>0)for(var e=0;e<t.branches.length;e++){var r=t.branches[e];if("origin/master"===r||"master"===r||"HEAD"===r||r.startsWith("HEAD "))return!0}return!1}var a=t.commitsList,i=r.trim().split("\n");n();for(var s=0;s<i.length;s++){var d=i[s];if(""!==d.trim()){d=d.split("|");var m=d[0],f=d[1]&&""!==d[1].trim(),b=document.getElementById("bit-booster-tbl"),g=b.insertRow(),p=g.insertCell(-1);g.id="T_"+m,g.setAttribute("data-commitid",m),p.setAttribute("class","commit"),p.textContent=m;var w={isDone:!1,isPlumbed:!1,sha1:m,x:v,row:a.length,htmlElement:p,col:0};if(a.push(w),h[w.sha1]=w,f&&(w.parents=d[1].split(" ")),d[2]&&""!==d[2].trim()){var y=c(d[2].trim());w.tags=y[0],w.branches=y[1]}}}for(s=0;s<a.length;s++)l(a[s]);var A=void 0;for(s=0;s<a.length;s++)if(w=a[s],o(w)){A=w;break}for(A||(A=a[0]),s=0;s<(A?A.row:a.length);s++)w=a[s],w.col++,w.x=v+u*w.col,e(s,0,A),console.log("Storing: "+A.sha1+" at row="+s);if(A){var C=A.plumb();if(C)for(s=C.row+1;s<a.length;s++)w=a[s],0===w.col&&(w.col++,w.x=v+u*w.col)}for(s=0;s<a.length;s++)a[s].plumb();for(s=a.length-1;s>=0;s--)a[s].draw();for(s=a.length-1;s>=0;s--)a[s].circle()}var m=["#034f84","#79c753","#f7786b","#fae03c","#98ddde","#9896a4","#dc4132","#b08e6a","#91a8d0","#f7cac9"],u=15,f=35,b=0,g=[],h=Object.create(null),v=9,p=function(){var e=t.commitsList;g=[];var r=i();if(r){for(var o=r[2],n=r[0],a=0,s=n;s<o.length;s++){r=o.item(s);var l=r.getAttribute("data-commitid");if(l){r.classList.remove("focused-commit");var c=e[a];if(!c||c.sha1!==l)break;var d=r.getElementsByClassName("commit").item(0);d&&(c.htmlElement=d.firstChild),c.isDone=!1,c.isPlumbed=!1,c.x=v,c.col=0,delete c.colorOverride,a++}}for(a<e.length&&e.splice(a,e.length-s);s<o.length;s++)r=o.item(s),r.classList.remove("focused-commit"),l=r.getAttribute("data-commitid"),l&&(d=r.getElementsByClassName("commit").item(0),d&&(r.id="T_"+l,c={isDone:!1,isPlumbed:!1,sha1:l,x:v,row:e.length,col:0,htmlElement:d.firstChild},e.push(c),h[c.sha1]=c))}};return p.g=d,p.commitsTable=h,p}function dg(r){cg();var o=document.getElementById("data");o&&(o.value=r);var n=a();n(),n.g(r);var i=t.svg;e("#bit-booster-tbl").find("tr").mouseenter(function(){var t=this.getAttribute("data-commitid");if(e("#T_"+t).addClass("commitHover"),t){var r=i.getElementById("C_"+t);r.setAttribute("class","commitHover")}}).mouseleave(function(){var t=this.getAttribute("data-commitid");if(e("#T_"+t).removeClass("commitHover"),t){var r=i.getElementById("C_"+t);r.removeAttribute("class")}}),e("#bit-booster").find("rect, circle").mouseenter(function(){sha=this.id.substring(2),e("#T_"+sha).addClass("commitHover")}).mouseleave(function(){sha=this.id.substring(2),e("#T_"+sha).removeClass("commitHover")});var s=t.style.outerHTML.toString(),l=document.getElementById("bit-booster-tbl");l=l.cloneNode(!0);for(var c=l.getElementsByTagName("rect"),d=c.length-1;d>=0;d--){var m=c.item(d);m.parentNode.removeChild(m)}var u=l.outerHTML.toString(),f=l.getElementsByTagName("svg").item(0).outerHTML.toString();f=vkbeautify.xml(f),u='<meta charset="UTF-8">\n'+vkbeautify.xml(s)+"\n<!-- http://bit-booster.com/graph.html  DATA WAS:\n"+r+"\n-->\n"+vkbeautify.xml(u);var b=new Blob([f],{type:"image/svg+xml"}),g=document.createElement("a");g.href=URL.createObjectURL(b),g.download="graph.svg",g.textContent="graph.svg";for(var h=document.getElementById("download");h.firstChild;)h.removeChild(h.firstChild);h.innerHTML="Download Graph: &nbsp; &nbsp; &nbsp; "+g.outerHTML;var v=document.getElementById("output");v.value=u}function cg(){if(t.svg&&t.svg.parentNode){var e=t.svg;e.parentNode.removeChild(e),t.svg=void 0;var r=a();for(var o in t.commitsList.length=0,r.commitsTable)delete r.commitsTable[o]}for(var i=document.getElementById("download");i&&i.firstChild;)i.removeChild(i.firstChild);var s=document.getElementById("bit-booster");s&&s.parentNode.removeChild(s);var l=document.getElementById("bit-booster-tbl");l&&l.parentNode.removeChild(l);var c=document.getElementById("data");c&&(c.value=""),c=document.getElementById("output"),c&&(c.value=""),n()}function rg(){cg();var t=document.getElementById("data"),e="539495f|a9d6243|master\n        a9d6243|8e17cfd dba91e2 cdadcd7 c954c3e 658b04e 8efa6b6 a2d7854\n        a2d7854|9d95af8\n        8efa6b6|9d95af8|test_branch\n        9d95af8\n        658b04e|9317a9b\n        c954c3e|9317a9b|tag: tag1\n        9317a9b\n        cdadcd7|f4046fa\n        dba91e2|f4046fa|tag: tag5, tag: tag6\n        f4046fa\n        8e17cfd|e34b4d0\n        e34b4d0|5ff6ce7\n        5ff6ce7|d86e7ce|tag: tag2, tag: tag3, another_branch\n        d86e7ce|44f3ead f537ede 79e536a\n        f537ede|653a6f6\n        79e536a|653a6f6 a1a7ab4\n        44f3ead|f2e7f46 653a6f6\n        653a6f6|422dd3c d3c5150\n        a1a7ab4|649a524\n        d3c5150|649a524\n        f2e7f46|422dd3c\n        422dd3c|649a524\n        649a524|90cd17a\n        90cd17a|76092f0 f37def6 0f8187b c44a61f 0b6fd60 66537bf f9c5353 17f5428 3c52fb4\n        76092f0\n        3c52fb4\n        17f5428||tag: x, tag: y, tag: z\n        f9c5353\n        66537bf\n        0b6fd60\n        c44a61f\n        0f8187b\n        f37def6";if(t){for(var r=e.split("\n"),o="",n=0;n<r.length;n++)o+=r[n].trim()+"\n";t.value=o.trim()}}var e=jQuery,r="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xlink",t=Object.create(null);t.commitsList=[];